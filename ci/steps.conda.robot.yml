parameters:
  name: Linux

steps:
  - task: CondaEnvironment@1
    inputs:
      createOptions: -c conda-forge -c defaults
      createCustomEnvironment: true
      updateConda: false
      environmentName: wxyz-robot
      packageSpecs: >
        bqplot
        cycler
        dask
        dask-ml
        distributed
        geckodriver
        importnb
        ipympl
        ipywidgets
        isort
        jinja2
        jsonpointer
        jupyterlab>=0.35.6,<0.36
        lime
        lxml
        matplotlib
        nodejs
        pandas
        pillow
        pip
        pyld
        pylint
        python>=3.7,<3.8.0a0
        pyyaml
        robotframework
        robotframework-seleniumlibrary
        scikit-image
        scikit-learn
        scikit-mdr
        skrebate
        tornado<6
        tpot
        traittypes
        umap-learn

  - script: python -m pip install --no-deps robotframework-jupyterlibrary
    displayName: JupyterLibrary from pip

  - ${{ if eq(parameters.name, 'Windows') }}:
    - script: python -m pip uninstall -y pyzmq && python -m pip install pyzmq
      displayName: pyzmq from pip
